(self.webpackChunkai_frontend=self.webpackChunkai_frontend||[]).push([[246,358],{75558:function(x,l,n){"use strict";n.r(l),n.d(l,{default:function(){return w}});var o=n(93236),p=n(14536),c=n(86004),C=n(47277),S=n(30279),f=n.n(S),j=n(94434),L=n.n(j),P=n(35290),r=n.n(P),T=n(411),g=n.n(T),U=n(46686),$=n.n(U),D=n(65713),F=n(17986),K=n(66122),G=n(61654),V=n(87976);function W(){return I.apply(this,arguments)}function I(){return I=g()(r()().mark(function d(){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",V.Z.get("oss/sign"));case 1:case"end":return s.stop()}},d)})),I.apply(this,arguments)}var h=n(62086),N=(0,o.memo)(function(d){var E=d.value,s=d.onChange,O=d.children,A=d.onUploaded,B=(0,o.useState)(),R=$()(B,2),a=R[0],Z=R[1],M=function(){var y=g()(r()().mark(function v(){var u,t;return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W();case 3:t=e.sent,Z(t==null||(u=t.data)===null||u===void 0?void 0:u.data),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),D.ZP.error("\u4E0A\u4F20\u5931\u8D25,\u8BF7\u7A0D\u540E\u91CD\u8BD5");case 11:case"end":return e.stop()}},v,null,[[0,7]])}));return function(){return y.apply(this,arguments)}}(),H=function(v){var u,t=v.fileList;console.log("Aliyun OSS:",t),s==null||s(L()(t)),t==null||(u=t.forEach)===null||u===void 0||u.call(t,function(i){if((i==null?void 0:i.percent)===100){var e=(a==null?void 0:a.host)+"/"+(i==null?void 0:i.url);A==null||A(e,i)}})},Q=function(v){return{key:v.url,OSSAccessKeyId:a==null?void 0:a.OSSAccessKeyId,policy:a==null?void 0:a.policy,Signature:a==null?void 0:a.Signature}},X=function(){var y=g()(r()().mark(function v(u){var t,i,e;return r()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(a){m.next=2;break}return m.abrupt("return",!1);case 2:if(t=Number(a.expire)*1e3,!(t<Date.now())){m.next=6;break}return m.next=6,M();case 6:return i=u.name.slice(u.name.lastIndexOf(".")),e=Date.now()+i,u.url=a.dir+"/"+e,m.abrupt("return",u);case 10:case"end":return m.stop()}},v)}));return function(u){return y.apply(this,arguments)}}(),Y={name:"file",fileList:E,multiple:!1,maxCount:1,accept:"video/*, image/*",action:a==null?void 0:a.host,onChange:H,data:Q,beforeUpload:X,showUploadList:!1};return(0,h.jsx)(F.Z,f()(f()({},Y),{},{children:O||(0,h.jsx)(K.Z,{onClick:function(){M()},icon:(0,h.jsx)(G.Z,{}),children:"\u70B9\u51FB\u4E0A\u4F20"})}))}),z=N,J=(0,o.memo)(function(d){var E=d.value,s=d.onChange,O=s===void 0?function(){}:s,A=function(Z){var M=Z.target.value;O(M)},B=(0,C.Z)(A,{wait:300}),R=B.run;return(0,h.jsxs)("div",{children:[(0,h.jsx)(p.default,{src:E}),(0,h.jsxs)(c.Z.Group,{compact:!0,children:[(0,h.jsx)(c.Z,{style:{width:"80%"},value:E,onChange:R})," ",(0,h.jsx)(z,{onUploaded:function(Z){O(Z)}})]})]})}),w=J},14536:function(x,l,n){"use strict";n.r(l),n.d(l,{default:function(){return L}});var o=n(93236),p=n(41385),c=n(17771),C=n(5476),S={preview:"preview___Rqv6O"},f=n(62086),j=(0,o.memo)(function(P){var r=P.src,T=(0,c.A)({sources:[{src:r}],autoplay:"muted"}),g=T.Video,U=(0,o.useMemo)(function(){return r?(0,C.fromExtension)(r):void 0},[r]),$=(0,o.useMemo)(function(){var D=null;return U==="image"&&(D=(0,f.jsx)(p.Z,{src:r,width:300})),U==="video"&&(D=(0,f.jsx)(g,{src:r,width:300})),D},[g,U,r]);return(0,f.jsx)("div",{className:S.preview,children:$})}),L=j},87976:function(x,l,n){"use strict";var o=n(13183),p="http://ai.tbanx.cn",c=o.Z.create({baseURL:"".concat(p,"/api/"),headers:{Authorization:"senv2wk7w4jo93fn(um40lfdc!dycp#fcupm7^1ocdh6d@bn0t"}});l.Z=c},72282:function(x,l,n){"use strict";n.d(l,{Z:function(){return c}});var o=n(38619),p=n(93236);function c(){var C=p.useReducer(function(j){return j+1},0),S=(0,o.Z)(C,2),f=S[1];return f}},62938:function(){}}]);
